# üéØ –¶–µ–ª–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–î–∞—Ç–∞:** 2025-11-01  
**–õ–∏–º–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:** 100  
**–§–æ–∫—É—Å:** –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

---

## üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:
1. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** - –ø—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö —Ä–∞–∑—Ä—ã–≤—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∫—Ä–∏—Ç–∏—á–Ω—ã
2. **–ó–∞—â–∏—Ç–∞ –æ—Ç DDoS** - –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = –±–æ–ª—å—à–µ —Ä–∏—Å–∫ –∞—Ç–∞–∫
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** - –Ω—É–∂–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU/–ø–∞–º—è—Ç—å
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –±—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- ‚ùå SQLite (JSON –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)
- ‚ùå –ö–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä —Å–ø—Ä–∞–≤–∏—Ç—Å—è)
- ‚ùå –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Ç–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞)

---

## üî¥ –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (—Ä–µ–∞–ª—å–Ω–æ –ø–æ–≤—ã—Å–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

---

### 1. Firewall –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DDoS ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö —Ä–∏—Å–∫ DDoS –∞—Ç–∞–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è. –ù—É–∂–Ω–∞ –∑–∞—â–∏—Ç–∞.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```bash
# –°–æ–∑–¥–∞—Ç—å /etc/iptables/vpn-rules.conf

# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã
iptables -A INPUT -p tcp --dport 10001:10100 -m state --state NEW -m limit --limit 10/minute -j ACCEPT

# –ó–∞—â–∏—Ç–∞ –æ—Ç SYN flood
iptables -A INPUT -p tcp --dport 10001:10100 --syn -m limit --limit 5/second -j ACCEPT

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –æ–¥–Ω–æ–≥–æ IP (–∑–∞—â–∏—Ç–∞ –æ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
iptables -A INPUT -p tcp --dport 10001:10100 -m connlimit --connlimit-above 10 --connlimit-mask 32 -j REJECT

# –†–∞–∑—Ä–µ—à–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
iptables -A INPUT -p tcp --dport 10001:10100 -m state --state ESTABLISHED,RELATED -j ACCEPT

# –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ
iptables -A INPUT -p tcp --dport 10001:10100 -j DROP
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ +30-40% –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS –∞—Ç–∞–∫
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ä—Ç-—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –∞—Ç–∞–∫–∞—Ö
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 30-60 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –ø—Ä–æ–±–ª–µ–º—ã –Ω—É–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –±—ã—Å—Ç—Ä–æ. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```python
# –°–∫—Ä–∏–ø—Ç /root/vpn-server/monitor_health.py

import subprocess
import time
import requests
import json

def check_xray():
    result = subprocess.run(['systemctl', 'is-active', 'xray'], 
                          capture_output=True, text=True)
    return result.stdout.strip() == 'active'

def check_ports():
    result = subprocess.run(['ss', '-tuln'], capture_output=True, text=True)
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –ø–æ—Ä—Ç—ã VPN –æ—Ç–∫—Ä—ã—Ç—ã
    expected_ports = set(range(10001, 10101))
    open_ports = set()
    for line in result.stdout.split('\n'):
        for port in expected_ports:
            if f':{port}' in line and 'LISTEN' in line:
                open_ports.add(port)
    return len(open_ports) >= len(expected_ports) * 0.95  # 95% –ø–æ—Ä—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã

def check_api():
    try:
        response = requests.get('https://localhost:8000/health', 
                              verify=False, timeout=5)
        return response.status_code == 200
    except:
        return False

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
if not check_xray():
    subprocess.run(['systemctl', 'restart', 'xray'])
    
if not check_api():
    subprocess.run(['systemctl', 'restart', 'vpn-api'])
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ +20-25% –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ú–µ–Ω—å—à–µ –ø—Ä–æ—Å—Ç–æ—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 1-2 —á–∞—Å–∞  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è connection tracking –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚≠ê‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö connection tracking –º–æ–∂–µ—Ç –±—ã—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º. –ù—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
```bash
# –í /etc/sysctl.conf –¥–æ–±–∞–≤–∏—Ç—å:

# –£–≤–µ–ª–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
net.netfilter.nf_conntrack_max = 2000000  # –±—ã–ª–æ 1000000

# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–π–º–∞—É—Ç—ã
net.netfilter.nf_conntrack_tcp_timeout_established = 86400  # 24 —á–∞—Å–∞
net.netfilter.nf_conntrack_tcp_timeout_time_wait = 60
net.netfilter.nf_conntrack_tcp_timeout_close_wait = 30

# –î–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
net.ipv4.tcp_max_syn_backlog = 16384  # –±—ã–ª–æ 8192
net.core.somaxconn = 8192             # –±—ã–ª–æ 4096
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ +15-20% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö
- ‚úÖ –ú–µ–Ω—å—à–µ –ø—Ä–æ–±–ª–µ–º —Å NAT
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

### 4. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ SNI –¥–ª—è Reality ‚≠ê‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ë–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = –±–æ–ª—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞ = –Ω—É–∂–Ω–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–û–±–Ω–æ–≤–∏—Ç—å `create_inbound_for_key()` –≤ `xray_config_manager.py`:
```python
"serverNames": [
    "www.microsoft.com",
    "www.cloudflare.com",
    "www.google.com",
    "www.github.com",          # –î–æ–±–∞–≤–∏—Ç—å
    "www.apple.com",           # –î–æ–±–∞–≤–∏—Ç—å
    "www.amazon.com"           # –î–æ–±–∞–≤–∏—Ç—å
]
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ: 6 SNI √ó 4 shortId = 24 –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (–±—ã–ª–æ 12)
- ‚úÖ +40% —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª—é—á–µ–π)

---

### 5. –£–ª—É—á—à–µ–Ω–∏–µ Policy –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ ‚≠ê‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ –º–Ω–æ–≥–æ –º–æ–±–∏–ª—å–Ω—ã—Ö. –ù—É–∂–Ω—ã –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–í `config.json` –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å policy:
```json
"policy": {
  "levels": {
    "0": {
      // –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
      "connIdle": 300,
      "handshake": 4
    },
    "1": {
      // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö - –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã
      "connIdle": 600,        // –£–≤–µ–ª–∏—á–∏—Ç—å —Å 300 –¥–æ 600
      "handshake": 8,         // –£–≤–µ–ª–∏—á–∏—Ç—å —Å 4 –¥–æ 8
      "uplinkOnly": 0,        // –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
      "downlinkOnly": 0       // –†–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
    }
  }
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ +25-30% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ç–µ–π
- ‚úÖ –õ—É—á—à–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 20-30 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

### 6. Graceful shutdown –¥–ª—è –ø–ª–∞–≤–Ω—ã—Ö –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤ ‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–ª–∞–≤–Ω—ã–º–∏.

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–í `/etc/systemd/system/xray.service`:
```ini
[Service]
TimeoutStopSec=30
KillMode=mixed
KillSignal=SIGTERM
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –ü–ª–∞–≤–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- ‚úÖ –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚úÖ +10% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

## üü° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–ø–æ–ª–µ–∑–Ω–æ, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

---

### 7. DNS –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à) ‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö DNS –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º.

**–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å dnsmasq/unbound –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ +30-50% —Å–∫–æ—Ä–æ—Å—Ç—å DNS –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ DNS
- ‚úÖ –ù–∏–∂–µ –∑–∞–¥–µ—Ä–∂–∫–∏

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 1 —á–∞—Å  
**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å DoH/DoT –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ)

---

### 8. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ TCP –¥–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ ‚≠ê‚≠ê‚≠ê

**–ó–∞—á–µ–º:** –ü—Ä–∏ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –Ω—É–∂–Ω—ã –±–æ–ª—å—à–∏–µ –±—É—Ñ–µ—Ä—ã –¥–ª—è –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
net.core.rmem_default = 262144
net.core.wmem_default = 262144
net.core.rmem_max = 33554432
net.core.wmem_max = 33554432
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ +10-15% –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ
- ‚úÖ –õ—É—á—à–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö –∫–∞–Ω–∞–ª–∞—Ö

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç

---

## ‚ùå –ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ:
1. ‚ùå SQLite - JSON –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. ‚ùå –ö–ª–∞—Å—Ç–µ—Ä - –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä —Å–ø—Ä–∞–≤–∏—Ç—Å—è
3. ‚ùå –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ - —Ç–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞
4. ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ dest –¥–ª—è Reality - –∏–∑–±—ã—Ç–æ—á–Ω–æ, —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞
5. ‚ùå TLS fingerprinting —Ä–æ—Ç–∞—Ü–∏—è - —Å–ª–æ–∂–Ω–æ, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç

---

## üìä –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –î–õ–Ø 100 –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô

### –ì—Ä—É–ø–ø–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Å–¥–µ–ª–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
1. **Firewall –ø—Ä–∞–≤–∏–ª–∞** - –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
3. **Connection tracking –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ

**–í—Ä–µ–º—è:** ~2-3 —á–∞—Å–∞  
**–≠—Ñ—Ñ–µ–∫—Ç:** +30-40% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

### –ì—Ä—É–ø–ø–∞ 2: –í–∞–∂–Ω—ã–µ (—Å–¥–µ–ª–∞—Ç—å –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
4. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ SNI** - –±–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
5. **Policy –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö** - —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
6. **Graceful shutdown** - –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏

**–í—Ä–µ–º—è:** ~1 —á–∞—Å  
**–≠—Ñ—Ñ–µ–∫—Ç:** +20-25% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

---

### –ì—Ä—É–ø–ø–∞ 3: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤—Ä–µ–º—è)
7. **DNS –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —É—Å–∫–æ—Ä–µ–Ω–∏–µ DNS
8. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ TCP** - –¥–ª—è –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫

**–í—Ä–µ–º—è:** ~1 —á–∞—Å  
**–≠—Ñ—Ñ–µ–∫—Ç:** +10-15% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üéØ –ò–¢–û–ì–û–í–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
1. ‚úÖ Firewall –ø—Ä–∞–≤–∏–ª–∞ (30-60 –º–∏–Ω)
2. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (1-2 —á–∞—Å–∞)
3. ‚úÖ Connection tracking (5 –º–∏–Ω)

**–ò—Ç–æ–≥–æ:** ~2-3 —á–∞—Å–∞  
**–≠—Ñ—Ñ–µ–∫—Ç:** +30-40% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –Ω–∞–±–æ—Ä:
1-3. –í—Å–µ –∏–∑ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
4. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ SNI (15 –º–∏–Ω)
5. ‚úÖ Policy –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (30 –º–∏–Ω)
6. ‚úÖ Graceful shutdown (5 –º–∏–Ω)

**–ò—Ç–æ–≥–æ:** ~3-4 —á–∞—Å–∞  
**–≠—Ñ—Ñ–µ–∫—Ç:** +50-60% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä:
1-6. –í—Å–µ –∏–∑ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –Ω–∞–±–æ—Ä–∞
7. ‚úÖ DNS –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (1 —á–∞—Å)
8. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ TCP (5 –º–∏–Ω)

**–ò—Ç–æ–≥–æ:** ~4-5 —á–∞—Å–æ–≤  
**–≠—Ñ—Ñ–µ–∫—Ç:** +60-70% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

## ‚úÖ –ì–ê–†–ê–ù–¢–ò–ò

- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–ª—é—á–∏ –ù–ï –∏–∑–º–µ–Ω—è—é—Ç—Å—è
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞
- –ú–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä—è—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ

---

## üìù –ó–ê–ú–ï–¢–ö–ò

1. **–î–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –∫—Ä–∏—Ç–∏—á–Ω—ã: –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
2. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–∏ —Ç–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ
3. **–ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** —Ç—Ä–µ–±—É—é—Ç –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è
4. **–†–µ—Å—É—Ä—Å—ã** –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã –¥–ª—è 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä ‚Üí –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π ‚Üí –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π

