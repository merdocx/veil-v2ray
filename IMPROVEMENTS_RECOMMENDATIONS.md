# üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é VPN —Å–µ—Ä–≤–∏—Å–∞

**–î–∞—Ç–∞:** 2025-11-01  
**–í–µ—Ä—Å–∏—è:** 2.2.0  
**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –¢–µ–∫—É—â–∏–µ –∫–ª—é—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ù–ï –∏–∑–º–µ–Ω—è—é—Ç—Å—è

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
- DNS —á–µ—Ä–µ–∑ DoH/DoT (Cloudflare, Quad9)
- TCP –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (BBR, Fast Open, keepalive)
- Policy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (idle timeout, handshake)
- Systemd hardening
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è Reality (3 SNI, 4 shortId)
- Rate limiting API
- LRU –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### üìà –ë–∞–∑–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –¥–æ 100
- Inbounds: 6
- –ü—Ä–æ—Ç–æ–∫–æ–ª: VLESS + Reality + TCP
- DNS: DoH/DoT (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ)

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

---

## 1. –°–ö–û–†–û–°–¢–¨ –°–û–ï–î–ò–ù–ï–ù–ò–Ø

### 1.1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ TCP (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–∫—É—â–∏–µ –±—É—Ñ–µ—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã –¥–ª—è –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –í /etc/sysctl.conf –¥–æ–±–∞–≤–∏—Ç—å:
net.core.rmem_default = 262144
net.core.wmem_default = 262144
net.core.rmem_max = 33554432
net.core.wmem_max = 33554432
net.ipv4.tcp_rmem = 4096 87380 33554432
net.ipv4.tcp_wmem = 4096 65536 33554432
net.ipv4.tcp_mem = 786432 1048576 33554432
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +15-25% –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- –õ—É—á—à–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö –∫–∞–Ω–∞–ª–∞—Ö
- –°—Ç–∞–±–∏–ª—å–Ω–µ–µ –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 10 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (—Ç–æ–ª—å–∫–æ –±—É—Ñ–µ—Ä—ã)

---

### 1.2. TCP Window Scaling –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** Window scaling –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è VPN —Ç—Ä–∞—Ñ–∏–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
```bash
net.ipv4.tcp_window_scaling = 1  # —É–∂–µ –µ—Å—Ç—å
net.ipv4.tcp_timestamps = 1      # —É–∂–µ –µ—Å—Ç—å
net.ipv4.tcp_sack = 1            # —É–∂–µ –µ—Å—Ç—å
# –î–æ–±–∞–≤–∏—Ç—å:
net.ipv4.tcp_adv_win_scale = 2
net.ipv4.tcp_app_win = 31
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +5-10% —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ –≤—ã—Å–æ–∫–∏—Ö –∑–∞–¥–µ—Ä–∂–∫–∞—Ö
- –õ—É—á—à–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–µ—Ç–∏

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç

---

### 1.3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ dest –¥–ª—è Reality (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω dest (www.microsoft.com:443)

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é dest –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —Å–∞–π—Ç–∞–º–∏
```json
// –í config.json –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–Ω—ã–µ dest –¥–ª—è —Ä–∞–∑–Ω—ã—Ö inbound
// –ù–æ —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è inbound
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +10-15% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏)
- –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ–¥–Ω–æ–≥–æ dest

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 1-2 —á–∞—Å–∞  
**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è inbound

---

## 2. –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–¨ –°–û–ï–î–ò–ù–ï–ù–ò–Ø

### 2.1. –£–ª—É—á—à–µ–Ω–∏–µ Policy –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–µ–∫—É—â–∏–µ —Ç–∞–π–º–∞—É—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–º–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–Ω—ã–µ policy levels –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
```json
"policy": {
  "levels": {
    "0": {
      // –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ - –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
      "connIdle": 300,
      "handshake": 4
    },
    "1": {
      // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π - –±–æ–ª–µ–µ –º—è–≥–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã
      "connIdle": 600,
      "handshake": 8,
      "uplinkOnly": 0,
      "downlinkOnly": 0
    }
  }
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +20-30% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- –ú–µ–Ω—å—à–µ —Ä–∞–∑—Ä—ã–≤–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ç–µ–π

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç  
**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –ù—É–∂–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

---

### 2.2. Graceful shutdown –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ Xray —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –æ–±—Ä—ã–≤–∞—é—Ç—Å—è —Ä–µ–∑–∫–æ

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å graceful shutdown
```bash
# –í systemd xray.service –¥–æ–±–∞–≤–∏—Ç—å:
TimeoutStopSec=30
KillMode=mixed
KillSignal=SIGTERM
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ü–ª–∞–≤–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- +10% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç

---

### 2.3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–±–ª–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å health checks –∏ –∞–ª–µ—Ä—Ç—ã
```python
# –ü—Ä–æ—Å—Ç–æ–π health check —Å–∫—Ä–∏–ø—Ç:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- +15% –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 2-3 —á–∞—Å–∞

---

### 2.4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è connection tracking (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** Connection tracking –º–æ–∂–µ—Ç –±—ã—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –í /etc/sysctl.conf:
net.netfilter.nf_conntrack_max = 2000000  # –±—ã–ª–æ 1000000
net.netfilter.nf_conntrack_tcp_timeout_established = 86400  # –±—ã–ª–æ 7200
net.netfilter.nf_conntrack_tcp_timeout_time_wait = 60      # –±—ã–ª–æ 120
net.netfilter.nf_conntrack_tcp_timeout_close_wait = 30     # –±—ã–ª–æ 60
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +10-15% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö
- –ú–µ–Ω—å—à–µ –ø—Ä–æ–±–ª–µ–º —Å NAT

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç

---

## 3. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –°–û–ï–î–ò–ù–ï–ù–ò–Ø

### 3.1. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ SNI –¥–ª—è Reality (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–ª—å–∫–æ 3 SNI, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö SNI
```json
"serverNames": [
  "www.microsoft.com",
  "www.cloudflare.com",
  "www.google.com",
  "www.github.com",          // –ù–æ–≤—ã–π
  "www.apple.com",           // –ù–æ–≤—ã–π
  "www.amazon.com"           // –ù–æ–≤—ã–π
]
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +30-40% —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞
- –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Ç–æ–≥–æ: 6 SNI √ó 4 shortId = 24 –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª—é—á–µ–π (—Å—Ç–∞—Ä—ã–µ –Ω–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã)

---

### 3.2. –£–ª—É—á—à–µ–Ω–∏–µ TLS fingerprinting –∑–∞—â–∏—Ç—ã (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** Fingerprint –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Ç—Ä–∞—Ñ–∏–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** 
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ TLS fingerprint –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –†–æ—Ç–∞—Ü–∏—è fingerprint patterns
- –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +20-30% —Å–∫—Ä—ã—Ç–Ω–æ—Å—Ç—å
- –°–ª–æ–∂–Ω–µ–µ –¥–µ—Ç–µ–∫—Ü–∏—è VPN —Ç—Ä–∞—Ñ–∏–∫–∞

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (—Å–ª–æ–∂–Ω–æ)  
**–í—Ä–µ–º—è:** 4-6 —á–∞—Å–æ–≤  
**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Xray –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

### 3.3. DPI (Deep Packet Inspection) –æ–±—Ö–æ–¥ (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** Reality —É–∂–µ –∑–∞—â–∏—â–∞–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

**–†–µ—à–µ–Ω–∏–µ:**
```json
// –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Reality –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
"realitySettings": {
  "show": false,              // –£–∂–µ –µ—Å—Ç—å
  "dest": "www.microsoft.com:443",
  "serverNames": [...],       // –£–∂–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ
  "shortIds": [...],          // –£–∂–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ
  "maxTimeDiff": 300          // –ú–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +10-15% –∑–∞—â–∏—Ç–∞ –æ—Ç DPI
- –õ—É—á—à–µ –∏–º–∏—Ç–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 30 –º–∏–Ω—É—Ç

---

### 3.4. Firewall –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ firewall

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# iptables –ø—Ä–∞–≤–∏–ª–∞:
# 1. Rate limiting –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
iptables -A INPUT -p tcp --dport 10001:10100 -m state --state NEW -m limit --limit 10/minute -j ACCEPT

# 2. –ó–∞—â–∏—Ç–∞ –æ—Ç SYN flood
iptables -A INPUT -p tcp --dport 10001:10100 --syn -m limit --limit 5/second -j ACCEPT

# 3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –æ–¥–Ω–æ–≥–æ IP
iptables -A INPUT -p tcp --dport 10001:10100 -m connlimit --connlimit-above 10 --connlimit-mask 32 -j REJECT
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +20-30% –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –∞—Ç–∞–∫–∞—Ö

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 1 —á–∞—Å

---

### 3.5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +15-20% –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (—Å–ª–æ–∂–Ω–æ)  
**–í—Ä–µ–º—è:** 4-6 —á–∞—Å–æ–≤

---

## 4. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

### 4.1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–æ–≤ Xray (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** Xray –º–æ–∂–µ—Ç –Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –í systemd xray.service:
CPUQuota=90%           # –±—ã–ª–æ 80%
TasksMax=10000         # –±—ã–ª–æ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +10-15% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –õ—É—á—à–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç

---

### 4.2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ DNS –∑–∞–ø—Ä–æ—Å–æ–≤ (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π DNS –∑–∞–ø—Ä–æ—Å –∏–¥–µ—Ç —á–µ—Ä–µ–∑ DoH/DoT (–º–µ–¥–ª–µ–Ω–Ω–æ)

**–†–µ—à–µ–Ω–∏–µ:** –õ–æ–∫–∞–ª—å–Ω—ã–π DNS –∫—ç—à (dnsmasq/unbound)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å dnsmasq:
apt-get install dnsmasq

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫—ç—à:
cache-size=10000
neg-ttl=60
max-ttl=3600
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +30-50% —Å–∫–æ—Ä–æ—Å—Ç—å DNS –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ DNS
- –ù–∏–∂–µ –∑–∞–¥–µ—Ä–∂–∫–∏

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê (—Å—Ä–µ–¥–Ω–µ)  
**–í—Ä–µ–º—è:** 1 —á–∞—Å

---

### 4.3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π (–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è SSD:
echo 'vm.swappiness=10' >> /etc/sysctl.conf
echo 'vm.vfs_cache_pressure=50' >> /etc/sysctl.conf
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- +5-10% –æ–±—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –õ—É—á—à–µ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê (–ø—Ä–æ—Å—Ç–æ)  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç

---

## üìä –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø

### üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Å–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å):

1. **Firewall –ø—Ä–∞–≤–∏–ª–∞** - –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS –∏ –∞—Ç–∞–∫ (1 —á–∞—Å)
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º (2-3 —á–∞—Å–∞)
3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ SNI** - –±–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è (15 –º–∏–Ω—É—Ç)
4. **DNS –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ (1 —á–∞—Å)

**–û–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç:**
- –°–∫–æ—Ä–æ—Å—Ç—å: +30-50%
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: +15-20%
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: +20-30%

---

### üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ TCP** - –¥–ª—è –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ (10 –º–∏–Ω—É—Ç)
6. **–£–ª—É—á—à–µ–Ω–∏–µ Policy –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö** - —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (30 –º–∏–Ω—É—Ç)
7. **Graceful shutdown** - –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏ (5 –º–∏–Ω—É—Ç)
8. **Connection tracking –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –¥–ª—è –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫ (5 –º–∏–Ω—É—Ç)

**–û–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç:**
- –°–∫–æ—Ä–æ—Å—Ç—å: +15-25%
- –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: +10-15%

---

### üü¢ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

9. **TCP Window Scaling** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ (5 –º–∏–Ω—É—Ç)
10. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è I/O** - –Ω–µ–±–æ–ª—å—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (5 –º–∏–Ω—É—Ç)
11. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ dest** - –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ (1-2 —á–∞—Å–∞)

**–û–±—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç:**
- –°–∫–æ—Ä–æ—Å—Ç—å: +5-10%

---

## üéØ –ò–¢–û–ì–û–í–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä (–±—ã—Å—Ç—Ä—ã–π —ç—Ñ—Ñ–µ–∫—Ç):
1. Firewall –ø—Ä–∞–≤–∏–ª–∞ (1 —á–∞—Å)
2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ SNI (15 –º–∏–Ω—É—Ç)
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ TCP (10 –º–∏–Ω—É—Ç)
4. Graceful shutdown (5 –º–∏–Ω—É—Ç)

**–í—Ä–µ–º—è:** ~2 —á–∞—Å–∞  
**–≠—Ñ—Ñ–µ–∫—Ç:** +20-30% —Å–∫–æ—Ä–æ—Å—Ç—å, +15% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, +25% –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é):
1. –í—Å–µ –∏–∑ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
2. DNS –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (1 —á–∞—Å)
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (2-3 —á–∞—Å–∞)
4. Policy –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (30 –º–∏–Ω—É—Ç)
5. Connection tracking (5 –º–∏–Ω—É—Ç)

**–í—Ä–µ–º—è:** ~4-5 —á–∞—Å–æ–≤  
**–≠—Ñ—Ñ–µ–∫—Ç:** +40-50% —Å–∫–æ—Ä–æ—Å—Ç—å, +25-30% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, +30-40% –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç):
1. –í—Å–µ –∏–∑ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
2. TLS fingerprinting –∑–∞—â–∏—Ç–∞ (4-6 —á–∞—Å–æ–≤)
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (4-6 —á–∞—Å–æ–≤)
4. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ dest (1-2 —á–∞—Å–∞)

**–í—Ä–µ–º—è:** ~10-15 —á–∞—Å–æ–≤  
**–≠—Ñ—Ñ–µ–∫—Ç:** +50-60% —Å–∫–æ—Ä–æ—Å—Ç—å, +35-40% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, +50-60% –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### ‚úÖ –ß—Ç–æ –ù–ï —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π:
- –í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤—ã—à–µ
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ TCP/sysctl
- Firewall –ø—Ä–∞–≤–∏–ª–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- DNS –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- Policy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### ‚ùå –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π:
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ Reality privateKey (–µ—Å–ª–∏ —Ä–æ—Ç–∞—Ü–∏—è)

---

## üìù –ó–ê–ú–ï–¢–ö–ò

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ä–∞–±–æ—Ç—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—é—á–µ–π
2. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ:** –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–æ –æ–¥–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã
4. **–ë—ç–∫–∞–ø—ã:** –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫:** –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚Üí –°—Ä–µ–¥–Ω–∏–π ‚Üí –ù–∏–∑–∫–∏–π

