# üîí –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò VPN API

## ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### üîë **1. API –ö–ª—é—á –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**

#### ‚ùå **–ë—ã–ª–æ:**
```python
# API –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
API_KEY = "QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM="
```

#### ‚úÖ **–°—Ç–∞–ª–æ:**
```python
# API –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
API_KEY = os.getenv("VPN_API_KEY", "QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM=")
```

#### üìÅ **–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.env`:**
```bash
# VPN API Configuration
VPN_API_KEY=QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM=
VPN_ENABLE_HTTPS=true
VPN_SSL_CERT_PATH=/etc/ssl/certs/vpn-api.crt
VPN_SSL_KEY_PATH=/etc/ssl/private/vpn-api.key
```

### üîê **2. HTTPS —Å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏**

#### ‚ùå **–ë—ã–ª–æ:**
- HTTP —Ç–æ–ª—å–∫–æ
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

#### ‚úÖ **–°—Ç–∞–ª–æ:**
- **HTTPS —Å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏**
- **–°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** —Å–æ–∑–¥–∞–Ω
- **Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω** –¥–ª—è HTTPS
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç** HTTP ‚Üí HTTPS

#### üîß **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ SSL:**
```nginx
# SSL configuration
ssl_certificate /etc/ssl/certs/vpn-api.crt;
ssl_certificate_key /etc/ssl/private/vpn-api.key;
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
```

### üõ°Ô∏è **3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

#### ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã security headers:**
```nginx
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
add_header X-Frame-Options DENY always;
add_header X-Content-Type-Options nosniff always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
```

#### ‚úÖ **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
- `.env` —Ñ–∞–π–ª: `600` (—Ç–æ–ª—å–∫–æ root)
- SSL –∫–ª—é—á: `600` (—Ç–æ–ª—å–∫–æ root)
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç: `644` (—á—Ç–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö)

### üîß **4. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

#### ‚úÖ **–°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ API –∫–ª—é—á–∞:**
```bash
python3 /root/vpn-server/generate_api_key.py
```

#### ‚úÖ **–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```bash
python3 /root/vpn-server/security_check.py
```

#### ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π systemd —Å–µ—Ä–≤–∏—Å:**
```ini
[Service]
EnvironmentFile=/root/vpn-server/.env
```

## üìä **–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–†–û–í–ï–†–ö–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò**

```
üîí –ü–†–û–í–ï–†–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò VPN API
==================================================
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ .env
‚úÖ API –∫–ª—é—á –Ω–∞–π–¥–µ–Ω –≤ .env
‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞–π–¥–µ–Ω—ã
‚úÖ HTTPS API —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
‚úÖ Nginx HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∞–∫—Ç–∏–≤–Ω—ã
‚úÖ –í—Å–µ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã

üìä –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢
‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: 6/6
üìà –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: 100.0%
üéâ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
```

## üöÄ **–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï**

### üîë **–°–º–µ–Ω–∞ API –∫–ª—é—á–∞:**
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞
python3 /root/vpn-server/generate_api_key.py

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
systemctl restart vpn-api
```

### üîç **–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
python3 /root/vpn-server/security_check.py
```

### üåê **–î–æ—Å—Ç—É–ø –∫ API:**
```bash
# HTTPS —á–µ—Ä–µ–∑ Nginx
curl -k -H "X-API-Key: YOUR_API_KEY" "https://veil-bird.ru/api/keys"

# –ü—Ä—è–º–æ–π HTTPS
curl -k -H "X-API-Key: YOUR_API_KEY" "https://localhost:8000/api/keys"
```

## üìã **–ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨**

### üîÑ **–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `api.py` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `systemd/vpn-api.service` - –¥–æ–±–∞–≤–ª–µ–Ω EnvironmentFile
- `nginx/vpn-api` - HTTPS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `.gitignore` - –∏—Å–∫–ª—é—á–µ–Ω .env —Ñ–∞–π–ª

### ‚ûï **–§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã:**
- `.env` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `generate_api_key.py` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è API –∫–ª—é—á–µ–π
- `security_check.py` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `SECURITY_IMPROVEMENTS.md` - —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç

### üîê **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:**
- `/etc/ssl/certs/vpn-api.crt` - —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- `/etc/ssl/private/vpn-api.key` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á

## ‚ö†Ô∏è **–í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø**

1. **API –∫–ª—é—á –±–æ–ª—å—à–µ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ä–æ–≤–∞–Ω** –≤ –∫–æ–¥–µ
2. **–í—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è** —á–µ—Ä–µ–∑ HTTPS
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç** HTTP ‚Üí HTTPS
4. **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** –Ω–∞ –≤—Å–µ —Ñ–∞–π–ª—ã
5. **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é

## üéØ **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò**

1. **–†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ API –∫–ª—é—á** (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü)
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
3. **–û–±–Ω–æ–≤–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–æ–≤** –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è HTTPS
4. **–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ Let's Encrypt** –¥–ª—è –≤–∞–ª–∏–¥–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
5. **–î–æ–±–∞–≤—å—Ç–µ rate limiting** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DDoS

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 2025-08-04  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** üîí –£–ª—É—á—à–µ–Ω–∞ 